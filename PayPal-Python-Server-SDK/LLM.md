# PayPal Python Server SDK – Consolidated API Reference

> Generated July 2025 from the latest `main` branch.

## Table of Contents
1. [Controllers Module](#controllers-module-api)
2. [Models Package](#models-package)
3. [Core Helpers](#core-helpers)

---

## Controllers Module API

### Overview
The `paypalserversdk.controllers` package bundles thin, generated wrappers around PayPal REST endpoints.
Every controller is **instantiated with a `Configuration` object** and returns an `ApiResponse` whose `.result` already contains the deserialized **model instance**.

```python
from paypalserversdk import configuration, paypal_serversdk_client

cfg = configuration.Configuration(
    environment=configuration.Environment.SANDBOX,
    client_credentials_auth_credentials=(CLIENT_ID, CLIENT_SECRET),
)

client = paypal_serversdk_client.PaypalServersdkClient(config=cfg)
```

```python
from paypalserversdk.configuration import Configuration
from paypalserversdk.controllers.orders_controller import OrdersController

config = Configuration(access_token="YOUR-OAUTH-TOKEN")
orders_api = OrdersController(config)
```

### Main Controllers

| Controller | Typical Import | Purpose |
|------------|----------------|---------|
| `OAuthAuthorizationController` | `from paypalserversdk.controllers.o_auth_authorization_controller import OAuthAuthorizationController` | Exchange client-credentials for access tokens. |
| `OrdersController`             | `from paypalserversdk.controllers.orders_controller import OrdersController` | Create, update, capture & authorize **checkout orders**. |
| `PaymentsController`           | `from paypalserversdk.controllers.payments_controller import PaymentsController` | Capture, refund, void individual payments. |
| `VaultController`              | `from paypalserversdk.controllers.vault_controller import VaultController` | Create setup / payment tokens and manage vault entries. |

#### Example – create & capture an order
```python
orders = OrdersController(config)
resp = orders.create_order({
    "prefer": "return=representation",
    "body": {
        "intent": "CAPTURE",
        "purchase_units": [{"amount": {"currency_code": "USD", "value": "100.00"}}]
    }
})
order_id = resp.result.id
orders.capture_order({"order_id": order_id})
```
### OAuthAuthorizationController

```python
from paypalserversdk.controllers.o_auth_authorization_controller import (
    OAuthAuthorizationController,
)

import base64

CLIENT_ID = "..."
CLIENT_SECRET = "..."

basic = base64.b64encode(f"{CLIENT_ID}:{CLIENT_SECRET}".encode()).decode()

auth_api = OAuthAuthorizationController(config)
token_resp = auth_api.request_token({"authorization": f"Basic {basic}"})
access_token = token_resp.result.access_token
```

### OrdersController

```python
from paypalserversdk.controllers.orders_controller import OrdersController

orders = OrdersController(config)

resp = orders.create_order({
    "prefer": "return=representation",
    "body": {
        "intent": "CAPTURE",
        "purchase_units": [
            {"amount": {"currency_code": "USD", "value": "100.00"}}
        ],
    },
})

order_id = resp.result.id
approve_url = next(l.href for l in resp.result.links if l.rel == "approve")
```


#### Notice of API Change
Legacy **`paypal-checkout-serversdk`** exposed request-object classes such as `OrdersCreateRequest`.  
The new SDK replaces them with direct **controller methods** that accept a plain `options` dictionary.

#### Missing Functionality
No generated controllers yet for **Webhooks, Subscriptions, Payouts, Reporting, Identity, Partner Referrals**.

---

## Models Package

The `paypalserversdk.models` namespace contains **≈280** auto-generated dataclasses that mirror PayPal REST schemas.

### Major Model Groups

| Group | Examples |
|-------|----------|
| Checkout / Orders | `Order`, `OrderRequest`, `PurchaseUnit`, `OrdersCapture` |
| Payments          | `Authorization`, `Capture`, `Refund`, `PaymentInstruction` |
| Vault & Tokens    | `SetupTokenRequest`, `VaultResponse`, `PaymentToken*` |
| Wallets           | `PayPalWallet*`, `GooglePay*`, `ApplePay*`, `VenmoWallet*` |
| APMs              | BLIK, Giropay, iDEAL, Sofort, P24, Trustly models |

Models expose `to_dict()` / `from_dict()` helpers and nested enums for strict typing.

#### Example – inspect an order
```python
order = client.orders.get_order("5O190127TN364715T").result  # models.Order
print(order.status)
print(order.purchase_units[0].amount.value)
```

#### Example – build a Money object

Models are plain dataclasses generated by APIMatic.  Use
`paypalserversdk.api_helper.APIHelper.to_dictionary(model)` to obtain a JSON-ready
mapping.

```python
from paypalserversdk.models.money import Money
from paypalserversdk.api_helper import APIHelper

usd_10 = Money(currency_code="USD", value="10.00")
print(APIHelper.to_dictionary(usd_10))
# {'currency_code': 'USD', 'value': '10.00'}
```


#### Notice of API Change
Previous SDKs returned **plain dicts**; new SDK returns **typed model objects**.

#### Missing Functionality
No models for Webhooks, Subscriptions/Billing Plans, Invoices, Payouts, Identity.

---

## Core Helpers

### Key Classes & Modules

| Helper | Purpose |
|--------|---------|
| `Configuration` | Central settings: environment (Sandbox/Prod), client credentials, timeouts, retries, logging. |
| `ApiHelper`     | Serialization, query-string building, enum handling. |
| `PayPalServerSdkClient` | Facade that lazily constructs controllers and wires OAuth2 auth. |
| `http` sub-package | Low-level `HttpRequest`, `HttpResponse`, `ApiResponse`, pluggable transports. |
| `logging.configuration` | Structured request/response logging with header masking. |
| `exceptions`    | Rich error hierarchy: `ErrorException`, `ApiException`, `OAuthProviderException`. |

### Recipe – create a client with custom logging
```python
import logging, sys
from paypalserversdk import configuration, paypal_serversdk_client
from paypalserversdk.logging.configuration import LoggingConfiguration

py_logger = logging.getLogger("paypal-sdk")
py_logger.addHandler(logging.StreamHandler(sys.stdout))
py_logger.setLevel(logging.DEBUG)

cfg = configuration.Configuration(
    environment=configuration.Environment.SANDBOX,
    client_credentials_auth_credentials=("CLIENT", "SECRET"),
    logging_configuration=LoggingConfiguration(logger=py_logger, log_level="DEBUG")
)

client = paypal_serversdk_client.PaypalServersdkClient(config=cfg)
```

#### Notice of API Change
`PayPalHttpClient` (old SDK) → **`PaypalServersdkClient`** with automatic OAuth.

#### Known Limitations
* Retry strategy is basic; no circuit-breaker out-of-the-box.
* Only client-credentials OAuth2 is implemented.
